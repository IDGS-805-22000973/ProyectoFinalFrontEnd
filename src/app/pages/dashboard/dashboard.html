<div class="dashboard-container">
  <h1 class="text-2xl font-semibold text-gray-900">Dashboard General</h1>
  
  @if (isLoading) {
    <mat-spinner></mat-spinner>
  } @else {
    <div class="grid-container">
      <!-- Tarjeta de Compras -->
      <mat-card class="dashboard-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>shopping_cart</mat-icon>
            Compras del Mes
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="card-value">{{totalComprasUltimoMes | currency}}</div>
          <div class="card-subtitle">Total acumulado</div>
        </mat-card-content>
      </mat-card>

      <!-- Tarjeta de Ventas -->
      <mat-card class="dashboard-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>attach_money</mat-icon>
            Ventas del Mes
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="card-value">{{totalVentasMes | currency}}</div>
          <div class="card-subtitle">Total acumulado</div>
        </mat-card-content>
      </mat-card>

      <!-- Tarjeta de Ventas Hoy -->
      <mat-card class="dashboard-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>today</mat-icon>
            Ventas Hoy
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="card-value">{{ventasHoy}}</div>
          <div class="card-subtitle">Transacciones</div>
        </mat-card-content>
      </mat-card>

      <!-- Tarjeta de Promedio Venta -->
      <mat-card class="dashboard-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>trending_up</mat-icon>
            Promedio Venta
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <div class="card-value">{{promedioVenta | currency}}</div>
          <div class="card-subtitle">Por transacción</div>
        </mat-card-content>
      </mat-card>

      <!-- Gráfico de Compras -->
      <mat-card class="dashboard-card chart-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>bar_chart</mat-icon>
            Histórico de Compras
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <canvas id="comprasChart"></canvas>
        </mat-card-content>
      </mat-card>

      <!-- Tabla de Últimas Compras -->
      <mat-card class="dashboard-card table-card">
        <mat-card-header>
          <mat-card-title>
            <mat-icon>list_alt</mat-icon>
            Últimas Compras
          </mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <table mat-table [dataSource]="comprasRecientes" class="recent-table">
            <ng-container matColumnDef="fechaCompra">
              <th mat-header-cell *matHeaderCellDef> Fecha </th>
              <td mat-cell *matCellDef="let compra"> {{compra.fechaCompra | date}} </td>
            </ng-container>

            <ng-container matColumnDef="proveedorNombre">
              <th mat-header-cell *matHeaderCellDef> Proveedor </th>
              <td mat-cell *matCellDef="let compra"> {{compra.proveedorNombre}} </td>
            </ng-container>

            <ng-container matColumnDef="total">
              <th mat-header-cell *matHeaderCellDef> Total </th>
              <td mat-cell *matCellDef="let compra"> {{compra.total | currency}} </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="['fechaCompra', 'proveedorNombre', 'total']"></tr>
            <tr mat-row *matRowDef="let row; columns: ['fechaCompra', 'proveedorNombre', 'total'];"></tr>
          </table>
        </mat-card-content>
      </mat-card>
    </div>
  }
</div>